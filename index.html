<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Todo List</title>
</head>
<body>
	
	<div class="container">
		<form>
			<input type="text" placeholder="Shit to get done" class="cloaca">
			<input type="submit" value="Pull the chain">
		</form>
		
		<div class="msgSection">
			<ul class="msgHere"></ul>
		</div>
	</div>


	<script>
		//shit to get done and shit done code here
		//two modes: shit to get done and shit done
		// USAR LOCALSTORAGE CON DIFERENTES NOMBRES EN SETITEM() PARA GUARDAR LO QUE YA ESTÁ HECHO Y LO NO HECHO TODAVÍA !!!!!!!! --> LA LOTERIAH!
		const cloaca = document.querySelector('input[type="text"]');
		const deposit = document.querySelector('.msgHere');
		const formie = document.querySelector('form');

		const storage = JSON.parse(localStorage.getItem('tasks')) || [];
		//const task = [];


		function loadStorage(st = []){

			console.table(st);

			//const tareas = JSON.parse(storage.tasks);

			const lay = st.reverse().map( tarea => {
				return `<li>${tarea.todo}</li>`
			}).join('');

			deposit.innerHTML = lay;

		}

		function saveShit(things){

			//obtengo el localstorage
			var entradas = JSON.parse(localStorage.getItem("tasks"));

			tareas = {};
			tareas.todo = things;
			tareas.done = false;

			//localStorage.setItem('tasks', JSON.stringify(storage));

			//le hago push a entradas(localstorage)
			entradas.push(tareas);
			localStorage.setItem('tasks', JSON.stringify(entradas));

			//console.log(task);


		}


		function renderShit(s){

			saveShit(s);
			
			
			const last = deposit.firstChild;


			const li = document.createElement('li');
			li.textContent = s;

			if(last == null){
				deposit.appendChild(li);
			}else{
				deposit.insertBefore(li, last);
			}

			formie.reset();

			console.table(storage);
		}


		function getShit(e){

			e.preventDefault();
			const shit = cloaca.value;

			renderShit(shit);

		}


		formie.addEventListener('submit', getShit);

		//window.addEventListener('load', loadStorage);
		loadStorage(storage);

	</script>

</body>
</html>